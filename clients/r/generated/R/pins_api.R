#' Pinterest REST API
#'
#' Pinterest's REST API
#'
#' The version of the OpenAPI document: 5.14.0
#' Contact: blah+oapicf@cliffano.com
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title Pins operations
#' @description PinsApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @examples
#' \dontrun{
#' ####################  MultiPinsAnalytics  ####################
#'
#' library(openapi)
#' var_pin_ids <- c("inner_example") # array[character] | List of Pin IDs.
#' var_start_date <- "start_date_example" # character | Metric report start date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days back from today.
#' var_end_date <- "end_date_example" # character | Metric report end date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days past start_date.
#' var_metric_types <- c(pins_analytics_metric_types_parameter_inner$new()) # array[PinsAnalyticsMetricTypesParameterInner] | Pin metric types to get data for.
#' var_app_types <- "ALL" # character | Apps or devices to get data for, default is all. (Optional)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Get multiple Pin analytics
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: client_credentials
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$MultiPinsAnalytics(var_pin_ids, var_start_date, var_end_date, var_metric_types, app_types = var_app_types, ad_account_id = var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$MultiPinsAnalytics(var_pin_ids, var_start_date, var_end_date, var_metric_types, app_types = var_app_types, ad_account_id = var_ad_account_id)
#' dput(result)
#'
#'
#' ####################  PinsAnalytics  ####################
#'
#' library(openapi)
#' var_pin_id <- "pin_id_example" # character | Unique identifier of a Pin.
#' var_start_date <- "start_date_example" # character | Metric report start date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days back from today.
#' var_end_date <- "end_date_example" # character | Metric report end date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days past start_date.
#' var_metric_types <- c(pins_analytics_metric_types_parameter_inner$new()) # array[PinsAnalyticsMetricTypesParameterInner] | Pin metric types to get data for. VIDEO_MRC_VIEW are Video views, VIDEO_V50_WATCH_TIME is Total play time. If Pin was created before <code>2023-03-20</code>, Profile visits and Follows will only be available for Idea Pins. These metrics are available for all Pin formats since then. Keep in mind this cannot have ALL if split_field is set to any value other than <code>NO_SPLIT</code>.
#' var_app_types <- "ALL" # character | Apps or devices to get data for, default is all. (Optional)
#' var_split_field <- "NO_SPLIT" # character | How to split the data into groups. Not including this param means data won't be split. (Optional)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Get Pin analytics
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: client_credentials
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PinsAnalytics(var_pin_id, var_start_date, var_end_date, var_metric_types, app_types = var_app_types, split_field = var_split_field, ad_account_id = var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$PinsAnalytics(var_pin_id, var_start_date, var_end_date, var_metric_types, app_types = var_app_types, split_field = var_split_field, ad_account_id = var_ad_account_id)
#' dput(result)
#'
#'
#' ####################  PinsCreate  ####################
#'
#' library(openapi)
#' var_pin_create <- PinCreate$new("id_example", "created_at_example", "link_example", "title_example", "description_example", "dominant_color_example", "alt_text_example", "board_id_example", "board_section_id_example", BoardOwner$new("username_example"), PinMedia$new("media_type_example"), PinMediaSource$new("pin_url", "image/jpeg", "data_example", "url_example", "media_id_example", c(PinMediaSourceImagesURL_items_inner$new("url_example", "title_example", "description_example", "link_example")), "is_standard_example", "cover_image_url_example", "image/jpeg", "cover_image_data_example", 123, "is_affiliate_link_example"), "parent_pin_id_example", "note_example") # PinCreate | Create a new Pin.
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Create Pin
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PinsCreate(var_pin_create, ad_account_id = var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$PinsCreate(var_pin_create, ad_account_id = var_ad_account_id)
#' dput(result)
#'
#'
#' ####################  PinsDelete  ####################
#'
#' library(openapi)
#' var_pin_id <- "pin_id_example" # character | Unique identifier of a Pin.
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Delete Pin
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' api_instance$PinsDelete(var_pin_id, ad_account_id = var_ad_account_id)
#'
#'
#' ####################  PinsGet  ####################
#'
#' library(openapi)
#' var_pin_id <- "pin_id_example" # character | Unique identifier of a Pin.
#' var_pin_metrics <- FALSE # character | Specify whether to return 90d and lifetime Pin metrics. Total comments and total reactions are only available with lifetime Pin metrics. If Pin was created before <code>2023-03-20</code> lifetime metrics will only be available for Video and Idea Pin formats. Lifetime metrics are available for all Pin formats since then. (Optional)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Get Pin
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: client_credentials
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PinsGet(var_pin_id, pin_metrics = var_pin_metrics, ad_account_id = var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$PinsGet(var_pin_id, pin_metrics = var_pin_metrics, ad_account_id = var_ad_account_id)
#' dput(result)
#'
#'
#' ####################  PinsList  ####################
#'
#' library(openapi)
#' var_bookmark <- "bookmark_example" # character | Cursor used to fetch the next page of items (Optional)
#' var_page_size <- 25 # integer | Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/reference/pagination/'>Pagination</a> for more information. (Optional)
#' var_pin_filter <- "pin_filter_example" # character | Pin filter. (Optional)
#' var_include_protected_pins <- FALSE # character | Specify if return pins from protected boards (Optional)
#' var_pin_type <- "pin_type_example" # character | The type of pins to return, currently only enabled for private pins (Optional)
#' var_creative_types <- c("REGULAR") # array[character] | Pin creative types filter. </p><strong>Note:</strong> SHOP_THE_PIN has been deprecated. Please use COLLECTION instead. (Optional)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#' var_pin_metrics <- FALSE # character | Specify whether to return 90d and lifetime Pin metrics. Total comments and total reactions are only available with lifetime Pin metrics. If Pin was created before <code>2023-03-20</code> lifetime metrics will only be available for Video and Idea Pin formats. Lifetime metrics are available for all Pin formats since then. (Optional)
#'
#' #List Pins
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: client_credentials
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PinsList(bookmark = var_bookmark, page_size = var_page_size, pin_filter = var_pin_filter, include_protected_pins = var_include_protected_pins, pin_type = var_pin_type, creative_types = var_creative_types, ad_account_id = var_ad_account_id, pin_metrics = var_pin_metricsdata_file = "result.txt")
#' result <- api_instance$PinsList(bookmark = var_bookmark, page_size = var_page_size, pin_filter = var_pin_filter, include_protected_pins = var_include_protected_pins, pin_type = var_pin_type, creative_types = var_creative_types, ad_account_id = var_ad_account_id, pin_metrics = var_pin_metrics)
#' dput(result)
#'
#'
#' ####################  PinsSave  ####################
#'
#' library(openapi)
#' var_pin_id <- "pin_id_example" # character | Unique identifier of a Pin.
#' var_pins_save_request <- pins_save_request$new("board_id_example", "board_section_id_example") # PinsSaveRequest | Request object used to save an existing pin
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Save Pin
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PinsSave(var_pin_id, var_pins_save_request, ad_account_id = var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$PinsSave(var_pin_id, var_pins_save_request, ad_account_id = var_ad_account_id)
#' dput(result)
#'
#'
#' ####################  PinsUpdate  ####################
#'
#' library(openapi)
#' var_pin_id <- "pin_id_example" # character | Unique identifier of a Pin.
#' var_pin_update <- PinUpdate$new("alt_text_example", "board_id_example", "board_section_id_example", "description_example", "link_example", "title_example", c(PinUpdate_carousel_slots_inner$new("title_example", "description_example", "link_example")), "note_example") # PinUpdate | 
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account. (Optional)
#'
#' #Update Pin
#' api_instance <- PinsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PinsUpdate(var_pin_id, var_pin_update, ad_account_id = var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$PinsUpdate(var_pin_id, var_pin_update, ad_account_id = var_ad_account_id)
#' dput(result)
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @export
PinsApi <- R6::R6Class(
  "PinsApi",
  public = list(
    api_client = NULL,

    #' @description
    #' Initialize a new PinsApi.
    #'
    #' @param api_client An instance of API client.
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },

    #' @description
    #' Get multiple Pin analytics
    #'
    #' @param pin_ids List of Pin IDs.
    #' @param start_date Metric report start date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days back from today.
    #' @param end_date Metric report end date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days past start_date.
    #' @param metric_types Pin metric types to get data for.
    #' @param app_types (optional) Apps or devices to get data for, default is all. (default value: "ALL")
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return map(map)
    MultiPinsAnalytics = function(pin_ids, start_date, end_date, metric_types, app_types = "ALL", ad_account_id = NULL, data_file = NULL, ...) {
      local_var_response <- self$MultiPinsAnalyticsWithHttpInfo(pin_ids, start_date, end_date, metric_types, app_types, ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Get multiple Pin analytics
    #'
    #' @param pin_ids List of Pin IDs.
    #' @param start_date Metric report start date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days back from today.
    #' @param end_date Metric report end date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days past start_date.
    #' @param metric_types Pin metric types to get data for.
    #' @param app_types (optional) Apps or devices to get data for, default is all. (default value: "ALL")
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (map(map)) with additional information such as HTTP status code, headers
    MultiPinsAnalyticsWithHttpInfo = function(pin_ids, start_date, end_date, metric_types, app_types = "ALL", ad_account_id = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_ids`)) {
        stop("Missing required parameter `pin_ids`.")
      }

      if (missing(`start_date`)) {
        stop("Missing required parameter `start_date`.")
      }

      if (missing(`end_date`)) {
        stop("Missing required parameter `end_date`.")
      }

      if (missing(`metric_types`)) {
        stop("Missing required parameter `metric_types`.")
      }

      if (length(`pin_ids`) > 100) {
        stop("Invalid length for `pin_ids` when calling PinsApi$MultiPinsAnalytics, number of items must be less than or equal to 100.")
      }
      if (length(`pin_ids`) < 1) {
        stop("Invalid length for `pin_ids` when calling PinsApi$MultiPinsAnalytics, number of items must be greater than or equal to 1.")
      }





      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$MultiPinsAnalytics, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$MultiPinsAnalytics, must conform to the pattern ^\\d+$.")
      }

      # explore
      for (query_item in `pin_ids`) {
        query_params[["pin_ids"]] <- c(query_params[["pin_ids"]], list(`pin_ids` = query_item))
      }

      query_params[["start_date"]] <- `start_date`

      query_params[["end_date"]] <- `end_date`

      if (!is.null(`app_types`) && !(`app_types` %in% c("ALL", "MOBILE", "TABLET", "WEB"))) {
        stop("Invalid value for app_types when calling PinsApi$MultiPinsAnalytics. Must be [ALL, MOBILE, TABLET, WEB].")
      }
      query_params[["app_types"]] <- `app_types`

      # no explore
      query_params[["metric_types"]] <- I(paste(lapply(`metric_types`, URLencode, reserved = TRUE), collapse = ","))

      query_params[["ad_account_id"]] <- `ad_account_id`

      local_var_url_path <- "/pins/analytics"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "map(map)", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' Get Pin analytics
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param start_date Metric report start date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days back from today.
    #' @param end_date Metric report end date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days past start_date.
    #' @param metric_types Pin metric types to get data for. VIDEO_MRC_VIEW are Video views, VIDEO_V50_WATCH_TIME is Total play time. If Pin was created before <code>2023-03-20</code>, Profile visits and Follows will only be available for Idea Pins. These metrics are available for all Pin formats since then. Keep in mind this cannot have ALL if split_field is set to any value other than <code>NO_SPLIT</code>.
    #' @param app_types (optional) Apps or devices to get data for, default is all. (default value: "ALL")
    #' @param split_field (optional) How to split the data into groups. Not including this param means data won't be split. (default value: "NO_SPLIT")
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return map(PinAnalyticsMetricsResponse)
    PinsAnalytics = function(pin_id, start_date, end_date, metric_types, app_types = "ALL", split_field = "NO_SPLIT", ad_account_id = NULL, data_file = NULL, ...) {
      local_var_response <- self$PinsAnalyticsWithHttpInfo(pin_id, start_date, end_date, metric_types, app_types, split_field, ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Get Pin analytics
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param start_date Metric report start date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days back from today.
    #' @param end_date Metric report end date (UTC). Format: YYYY-MM-DD. Cannot be more than 90 days past start_date.
    #' @param metric_types Pin metric types to get data for. VIDEO_MRC_VIEW are Video views, VIDEO_V50_WATCH_TIME is Total play time. If Pin was created before <code>2023-03-20</code>, Profile visits and Follows will only be available for Idea Pins. These metrics are available for all Pin formats since then. Keep in mind this cannot have ALL if split_field is set to any value other than <code>NO_SPLIT</code>.
    #' @param app_types (optional) Apps or devices to get data for, default is all. (default value: "ALL")
    #' @param split_field (optional) How to split the data into groups. Not including this param means data won't be split. (default value: "NO_SPLIT")
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (map(PinAnalyticsMetricsResponse)) with additional information such as HTTP status code, headers
    PinsAnalyticsWithHttpInfo = function(pin_id, start_date, end_date, metric_types, app_types = "ALL", split_field = "NO_SPLIT", ad_account_id = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_id`)) {
        stop("Missing required parameter `pin_id`.")
      }

      if (missing(`start_date`)) {
        stop("Missing required parameter `start_date`.")
      }

      if (missing(`end_date`)) {
        stop("Missing required parameter `end_date`.")
      }

      if (missing(`metric_types`)) {
        stop("Missing required parameter `metric_types`.")
      }







      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsAnalytics, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsAnalytics, must conform to the pattern ^\\d+$.")
      }

      query_params[["start_date"]] <- `start_date`

      query_params[["end_date"]] <- `end_date`

      if (!is.null(`app_types`) && !(`app_types` %in% c("ALL", "MOBILE", "TABLET", "WEB"))) {
        stop("Invalid value for app_types when calling PinsApi$PinsAnalytics. Must be [ALL, MOBILE, TABLET, WEB].")
      }
      query_params[["app_types"]] <- `app_types`

      # no explore
      query_params[["metric_types"]] <- I(paste(lapply(`metric_types`, URLencode, reserved = TRUE), collapse = ","))

      if (!is.null(`split_field`) && !(`split_field` %in% c("NO_SPLIT", "APP_TYPE"))) {
        stop("Invalid value for split_field when calling PinsApi$PinsAnalytics. Must be [NO_SPLIT, APP_TYPE].")
      }
      query_params[["split_field"]] <- `split_field`

      query_params[["ad_account_id"]] <- `ad_account_id`

      local_var_url_path <- "/pins/{pin_id}/analytics"
      if (!missing(`pin_id`)) {
        local_var_url_path <- gsub("\\{pin_id\\}", URLencode(as.character(`pin_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "map(PinAnalyticsMetricsResponse)", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' Create Pin
    #'
    #' @param pin_create Create a new Pin.
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return Pin
    PinsCreate = function(pin_create, ad_account_id = NULL, data_file = NULL, ...) {
      local_var_response <- self$PinsCreateWithHttpInfo(pin_create, ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Create Pin
    #'
    #' @param pin_create Create a new Pin.
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (Pin) with additional information such as HTTP status code, headers
    PinsCreateWithHttpInfo = function(pin_create, ad_account_id = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_create`)) {
        stop("Missing required parameter `pin_create`.")
      }


      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsCreate, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsCreate, must conform to the pattern ^\\d+$.")
      }

      query_params[["ad_account_id"]] <- `ad_account_id`

      if (!is.null(`pin_create`)) {
        local_var_body <- `pin_create`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/pins"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read boards:write pins:read pins:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "Pin", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' Delete Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param ... Other optional arguments
    #'
    #' @return void
    PinsDelete = function(pin_id, ad_account_id = NULL, ...) {
      local_var_response <- self$PinsDeleteWithHttpInfo(pin_id, ad_account_id, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Delete Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param ... Other optional arguments
    #'
    #' @return API response (void) with additional information such as HTTP status code, headers
    PinsDeleteWithHttpInfo = function(pin_id, ad_account_id = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_id`)) {
        stop("Missing required parameter `pin_id`.")
      }


      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsDelete, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsDelete, must conform to the pattern ^\\d+$.")
      }

      query_params[["ad_account_id"]] <- `ad_account_id`

      local_var_url_path <- "/pins/{pin_id}"
      if (!missing(`pin_id`)) {
        local_var_url_path <- gsub("\\{pin_id\\}", URLencode(as.character(`pin_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read boards:write pins:read pins:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "DELETE",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        local_var_resp$content <- NULL
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' Get Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param pin_metrics (optional) Specify whether to return 90d and lifetime Pin metrics. Total comments and total reactions are only available with lifetime Pin metrics. If Pin was created before <code>2023-03-20</code> lifetime metrics will only be available for Video and Idea Pin formats. Lifetime metrics are available for all Pin formats since then. (default value: FALSE)
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return Pin
    PinsGet = function(pin_id, pin_metrics = FALSE, ad_account_id = NULL, data_file = NULL, ...) {
      local_var_response <- self$PinsGetWithHttpInfo(pin_id, pin_metrics, ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Get Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param pin_metrics (optional) Specify whether to return 90d and lifetime Pin metrics. Total comments and total reactions are only available with lifetime Pin metrics. If Pin was created before <code>2023-03-20</code> lifetime metrics will only be available for Video and Idea Pin formats. Lifetime metrics are available for all Pin formats since then. (default value: FALSE)
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (Pin) with additional information such as HTTP status code, headers
    PinsGetWithHttpInfo = function(pin_id, pin_metrics = FALSE, ad_account_id = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_id`)) {
        stop("Missing required parameter `pin_id`.")
      }



      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsGet, must conform to the pattern ^\\d+$.")
      }

      query_params[["pin_metrics"]] <- `pin_metrics`

      query_params[["ad_account_id"]] <- `ad_account_id`

      local_var_url_path <- "/pins/{pin_id}"
      if (!missing(`pin_id`)) {
        local_var_url_path <- gsub("\\{pin_id\\}", URLencode(as.character(`pin_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "Pin", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' List Pins
    #'
    #' @param bookmark (optional) Cursor used to fetch the next page of items
    #' @param page_size (optional) Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/reference/pagination/'>Pagination</a> for more information. (default value: 25)
    #' @param pin_filter (optional) Pin filter.
    #' @param include_protected_pins (optional) Specify if return pins from protected boards (default value: FALSE)
    #' @param pin_type (optional) The type of pins to return, currently only enabled for private pins
    #' @param creative_types (optional) Pin creative types filter. </p><strong>Note:</strong> SHOP_THE_PIN has been deprecated. Please use COLLECTION instead.
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param pin_metrics (optional) Specify whether to return 90d and lifetime Pin metrics. Total comments and total reactions are only available with lifetime Pin metrics. If Pin was created before <code>2023-03-20</code> lifetime metrics will only be available for Video and Idea Pin formats. Lifetime metrics are available for all Pin formats since then. (default value: FALSE)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return PinsList200Response
    PinsList = function(bookmark = NULL, page_size = 25, pin_filter = NULL, include_protected_pins = FALSE, pin_type = NULL, creative_types = NULL, ad_account_id = NULL, pin_metrics = FALSE, data_file = NULL, ...) {
      local_var_response <- self$PinsListWithHttpInfo(bookmark, page_size, pin_filter, include_protected_pins, pin_type, creative_types, ad_account_id, pin_metrics, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' List Pins
    #'
    #' @param bookmark (optional) Cursor used to fetch the next page of items
    #' @param page_size (optional) Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/reference/pagination/'>Pagination</a> for more information. (default value: 25)
    #' @param pin_filter (optional) Pin filter.
    #' @param include_protected_pins (optional) Specify if return pins from protected boards (default value: FALSE)
    #' @param pin_type (optional) The type of pins to return, currently only enabled for private pins
    #' @param creative_types (optional) Pin creative types filter. </p><strong>Note:</strong> SHOP_THE_PIN has been deprecated. Please use COLLECTION instead.
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param pin_metrics (optional) Specify whether to return 90d and lifetime Pin metrics. Total comments and total reactions are only available with lifetime Pin metrics. If Pin was created before <code>2023-03-20</code> lifetime metrics will only be available for Video and Idea Pin formats. Lifetime metrics are available for all Pin formats since then. (default value: FALSE)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (PinsList200Response) with additional information such as HTTP status code, headers
    PinsListWithHttpInfo = function(bookmark = NULL, page_size = 25, pin_filter = NULL, include_protected_pins = FALSE, pin_type = NULL, creative_types = NULL, ad_account_id = NULL, pin_metrics = FALSE, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE


      if (`page_size` > 250) {
        stop("Invalid value for `page_size` when calling PinsApi$PinsList, must be smaller than or equal to 250.")
      }
      if (`page_size` < 1) {
        stop("Invalid value for `page_size` when calling PinsApi$PinsList, must be bigger than or equal to 1.")
      }





      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsList, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsList, must conform to the pattern ^\\d+$.")
      }


      query_params[["bookmark"]] <- `bookmark`

      query_params[["page_size"]] <- `page_size`

      if (!is.null(`pin_filter`) && !(`pin_filter` %in% c("exclude_native", "exclude_repins", "has_been_promoted"))) {
        stop("Invalid value for pin_filter when calling PinsApi$PinsList. Must be [exclude_native, exclude_repins, has_been_promoted].")
      }
      query_params[["pin_filter"]] <- `pin_filter`

      query_params[["include_protected_pins"]] <- `include_protected_pins`

      if (!is.null(`pin_type`) && !(`pin_type` %in% c("PRIVATE"))) {
        stop("Invalid value for pin_type when calling PinsApi$PinsList. Must be [PRIVATE].")
      }
      query_params[["pin_type"]] <- `pin_type`

      # explore
      for (query_item in `creative_types`) {
        # validate enum values
        if (!is.null(query_item) && !(query_item %in% c("REGULAR", "VIDEO", "SHOPPING", "CAROUSEL", "MAX_VIDEO", "SHOP_THE_PIN", "COLLECTION", "IDEA"))) {
          stop("Invalid value for creative_types when calling PinsApi$PinsList. Must be [REGULAR, VIDEO, SHOPPING, CAROUSEL, MAX_VIDEO, SHOP_THE_PIN, COLLECTION, IDEA].")
        }
        query_params[["creative_types"]] <- c(query_params[["creative_types"]], list(`creative_types` = query_item))
      }

      query_params[["ad_account_id"]] <- `ad_account_id`

      query_params[["pin_metrics"]] <- `pin_metrics`

      local_var_url_path <- "/pins"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read pins:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "PinsList200Response", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' Save Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param pins_save_request Request object used to save an existing pin
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return Pin
    PinsSave = function(pin_id, pins_save_request, ad_account_id = NULL, data_file = NULL, ...) {
      local_var_response <- self$PinsSaveWithHttpInfo(pin_id, pins_save_request, ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Save Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param pins_save_request Request object used to save an existing pin
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (Pin) with additional information such as HTTP status code, headers
    PinsSaveWithHttpInfo = function(pin_id, pins_save_request, ad_account_id = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_id`)) {
        stop("Missing required parameter `pin_id`.")
      }

      if (missing(`pins_save_request`)) {
        stop("Missing required parameter `pins_save_request`.")
      }



      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsSave, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsSave, must conform to the pattern ^\\d+$.")
      }

      query_params[["ad_account_id"]] <- `ad_account_id`

      if (!is.null(`pins_save_request`)) {
        local_var_body <- `pins_save_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/pins/{pin_id}/save"
      if (!missing(`pin_id`)) {
        local_var_url_path <- gsub("\\{pin_id\\}", URLencode(as.character(`pin_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read boards:write pins:read pins:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "Pin", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },

    #' @description
    #' Update Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param pin_update 
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return Pin
    PinsUpdate = function(pin_id, pin_update, ad_account_id = NULL, data_file = NULL, ...) {
      local_var_response <- self$PinsUpdateWithHttpInfo(pin_id, pin_update, ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },

    #' @description
    #' Update Pin
    #'
    #' @param pin_id Unique identifier of a Pin.
    #' @param pin_update 
    #' @param ad_account_id (optional) Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #'
    #' @return API response (Pin) with additional information such as HTTP status code, headers
    PinsUpdateWithHttpInfo = function(pin_id, pin_update, ad_account_id = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`pin_id`)) {
        stop("Missing required parameter `pin_id`.")
      }

      if (missing(`pin_update`)) {
        stop("Missing required parameter `pin_update`.")
      }



      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling PinsApi$PinsUpdate, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling PinsApi$PinsUpdate, must conform to the pattern ^\\d+$.")
      }

      query_params[["ad_account_id"]] <- `ad_account_id`

      if (!is.null(`pin_update`)) {
        local_var_body <- `pin_update`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/pins/{pin_id}"
      if (!missing(`pin_id`)) {
        local_var_url_path <- gsub("\\{pin_id\\}", URLencode(as.character(`pin_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "boards:read boards:write pins:read pins:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "PATCH",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "Pin", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    }
  )
)
