#' Pinterest REST API
#'
#' Pinterest's REST API
#'
#' The version of the OpenAPI document: 5.12.0
#' Contact: blah+oapicf@cliffano.com
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title ConversionTags operations
#' @description ConversionTagsApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @section Methods:
#' \describe{
#' \strong{ ConversionTagsCreate } \emph{ Create conversion tag }
#' Create a conversion tag, also known as <a href=\"https://help.pinterest.com/en/business/article/set-up-the-pinterest-tag\" target=\"_blank\">Pinterest tag</a>, with the option to enable enhanced match.<p/> The Pinterest Tag tracks actions people take on the ad account’s website after they view the ad account's ad on Pinterest. The advertiser needs to customize this tag to track conversions.<p/> For more information, see:<p/> <a class=\"reference external\" href=\"https://help.pinterest.com/en/business/article/set-up-the-pinterest-tag\">Set up the Pinterest tag</a><p/> <a class=\"reference external\" href=\"https://developers.pinterest.com/docs/conversions/pinterest-tag/\">Pinterest Tag</a><p/> <a class=\"reference external\" href=\"https://developers.pinterest.com/docs/conversions/enhanced-match/\">Enhanced match</a>
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } conversion_tag_create \link{ConversionTagCreate}
#' \item \emph{ @returnType } \link{ConversionTagResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : ConversionTagResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ ConversionTagsGet } \emph{ Get conversion tag }
#' Get information about an existing conversion tag.
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } conversion_tag_id character
#' \item \emph{ @returnType } \link{ConversionTagResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : ConversionTagResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ ConversionTagsList } \emph{ Get conversion tags }
#' List conversion tags associated with an ad account.
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } filter_deleted character
#' \item \emph{ @returnType } \link{ConversionTagListResponse} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : ConversionTagListResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ OcpmEligibleConversionTagsGet } \emph{ Get Ocpm eligible conversion tags }
#' Get Ocpm eligible conversion tag events for an ad account.
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @returnType } named list( \link{array} ) \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : map(array[ConversionEventResponse])
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected errors
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ PageVisitConversionTagsGet } \emph{ Get page visit conversion tags }
#' Get all page visit conversion tag events for an ad account.
#'
#' \itemize{
#' \item \emph{ @param } ad_account_id character
#' \item \emph{ @param } page_size integer
#' \item \emph{ @param } order Enum < [ASCENDING, DESCENDING] >
#' \item \emph{ @param } bookmark character
#' \item \emph{ @returnType } \link{PageVisitConversionTagsGet200Response} \cr
#'
#'
#' \item status code : 200 | Success
#'
#' \item return type : PageVisitConversionTagsGet200Response
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | Unexpected error
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' }
#'
#'
#' @examples
#' \dontrun{
#' ####################  ConversionTagsCreate  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_conversion_tag_create <- ConversionTagCreate$new("name_example", "aem_enabled_example", 123, "aem_fnln_enabled_example", "aem_ph_enabled_example", "aem_ge_enabled_example", "aem_db_enabled_example", "aem_loc_enabled_example") # ConversionTagCreate | Conversion Tag to create
#'
#' #Create conversion tag
#' api_instance <- ConversionTagsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$ConversionTagsCreate(var_ad_account_id, var_conversion_tag_createdata_file = "result.txt")
#' result <- api_instance$ConversionTagsCreate(var_ad_account_id, var_conversion_tag_create)
#' dput(result)
#'
#'
#' ####################  ConversionTagsGet  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_conversion_tag_id <- "2617998078212" # character | Id of the conversion tag.
#'
#' #Get conversion tag
#' api_instance <- ConversionTagsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$ConversionTagsGet(var_ad_account_id, var_conversion_tag_iddata_file = "result.txt")
#' result <- api_instance$ConversionTagsGet(var_ad_account_id, var_conversion_tag_id)
#' dput(result)
#'
#'
#' ####################  ConversionTagsList  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_filter_deleted <- FALSE # character | Filter out deleted tags. (Optional)
#'
#' #Get conversion tags
#' api_instance <- ConversionTagsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$ConversionTagsList(var_ad_account_id, filter_deleted = var_filter_deleteddata_file = "result.txt")
#' result <- api_instance$ConversionTagsList(var_ad_account_id, filter_deleted = var_filter_deleted)
#' dput(result)
#'
#'
#' ####################  OcpmEligibleConversionTagsGet  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#'
#' #Get Ocpm eligible conversion tags
#' api_instance <- ConversionTagsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$OcpmEligibleConversionTagsGet(var_ad_account_iddata_file = "result.txt")
#' result <- api_instance$OcpmEligibleConversionTagsGet(var_ad_account_id)
#' dput(result)
#'
#'
#' ####################  PageVisitConversionTagsGet  ####################
#'
#' library(openapi)
#' var_ad_account_id <- "ad_account_id_example" # character | Unique identifier of an ad account.
#' var_page_size <- 25 # integer | Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/getting-started/pagination/'>Pagination</a> for more information. (Optional)
#' var_order <- "ASCENDING" # character | The order in which to sort the items returned: “ASCENDING” or “DESCENDING” by ID. Note that higher-value IDs are associated with more-recently added items. (Optional)
#' var_bookmark <- "bookmark_example" # character | Cursor used to fetch the next page of items (Optional)
#'
#' #Get page visit conversion tags
#' api_instance <- ConversionTagsApi$new()
#'
#' # Configure OAuth2 access token for authorization: pinterest_oauth2
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$PageVisitConversionTagsGet(var_ad_account_id, page_size = var_page_size, order = var_order, bookmark = var_bookmarkdata_file = "result.txt")
#' result <- api_instance$PageVisitConversionTagsGet(var_ad_account_id, page_size = var_page_size, order = var_order, bookmark = var_bookmark)
#' dput(result)
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @export
ConversionTagsApi <- R6::R6Class(
  "ConversionTagsApi",
  public = list(
    api_client = NULL,
    #' Initialize a new ConversionTagsApi.
    #'
    #' @description
    #' Initialize a new ConversionTagsApi.
    #'
    #' @param api_client An instance of API client.
    #' @export
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },
    #' Create conversion tag
    #'
    #' @description
    #' Create conversion tag
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param conversion_tag_create Conversion Tag to create
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ConversionTagResponse
    #' @export
    ConversionTagsCreate = function(ad_account_id, conversion_tag_create, data_file = NULL, ...) {
      local_var_response <- self$ConversionTagsCreateWithHttpInfo(ad_account_id, conversion_tag_create, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Create conversion tag
    #'
    #' @description
    #' Create conversion tag
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param conversion_tag_create Conversion Tag to create
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ConversionTagResponse) with additional information such as HTTP status code, headers
    #' @export
    ConversionTagsCreateWithHttpInfo = function(ad_account_id, conversion_tag_create, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (missing(`conversion_tag_create`)) {
        stop("Missing required parameter `conversion_tag_create`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling ConversionTagsApi$ConversionTagsCreate, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling ConversionTagsApi$ConversionTagsCreate, must conform to the pattern ^\\d+$.")
      }


      if (!is.null(`conversion_tag_create`)) {
        local_var_body <- `conversion_tag_create`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/ad_accounts/{ad_account_id}/conversion_tags"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "ConversionTagResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Get conversion tag
    #'
    #' @description
    #' Get conversion tag
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param conversion_tag_id Id of the conversion tag.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ConversionTagResponse
    #' @export
    ConversionTagsGet = function(ad_account_id, conversion_tag_id, data_file = NULL, ...) {
      local_var_response <- self$ConversionTagsGetWithHttpInfo(ad_account_id, conversion_tag_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get conversion tag
    #'
    #' @description
    #' Get conversion tag
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param conversion_tag_id Id of the conversion tag.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ConversionTagResponse) with additional information such as HTTP status code, headers
    #' @export
    ConversionTagsGetWithHttpInfo = function(ad_account_id, conversion_tag_id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (missing(`conversion_tag_id`)) {
        stop("Missing required parameter `conversion_tag_id`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling ConversionTagsApi$ConversionTagsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling ConversionTagsApi$ConversionTagsGet, must conform to the pattern ^\\d+$.")
      }

      if (nchar(`conversion_tag_id`) > 18) {
        stop("Invalid length for `conversion_tag_id` when calling ConversionTagsApi$ConversionTagsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`conversion_tag_id`, "^\\d+$")) {
        stop("Invalid value for `conversion_tag_id` when calling ConversionTagsApi$ConversionTagsGet, must conform to the pattern ^\\d+$.")
      }

      local_var_url_path <- "/ad_accounts/{ad_account_id}/conversion_tags/{conversion_tag_id}"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      if (!missing(`conversion_tag_id`)) {
        local_var_url_path <- gsub("\\{conversion_tag_id\\}", URLencode(as.character(`conversion_tag_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "ConversionTagResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Get conversion tags
    #'
    #' @description
    #' Get conversion tags
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param filter_deleted (optional) Filter out deleted tags. (default value: FALSE)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ConversionTagListResponse
    #' @export
    ConversionTagsList = function(ad_account_id, filter_deleted = FALSE, data_file = NULL, ...) {
      local_var_response <- self$ConversionTagsListWithHttpInfo(ad_account_id, filter_deleted, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get conversion tags
    #'
    #' @description
    #' Get conversion tags
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param filter_deleted (optional) Filter out deleted tags. (default value: FALSE)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ConversionTagListResponse) with additional information such as HTTP status code, headers
    #' @export
    ConversionTagsListWithHttpInfo = function(ad_account_id, filter_deleted = FALSE, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling ConversionTagsApi$ConversionTagsList, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling ConversionTagsApi$ConversionTagsList, must conform to the pattern ^\\d+$.")
      }


      query_params[["filter_deleted"]] <- `filter_deleted`

      local_var_url_path <- "/ad_accounts/{ad_account_id}/conversion_tags"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "ConversionTagListResponse", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Get Ocpm eligible conversion tags
    #'
    #' @description
    #' Get Ocpm eligible conversion tags
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return map(array[ConversionEventResponse])
    #' @export
    OcpmEligibleConversionTagsGet = function(ad_account_id, data_file = NULL, ...) {
      local_var_response <- self$OcpmEligibleConversionTagsGetWithHttpInfo(ad_account_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get Ocpm eligible conversion tags
    #'
    #' @description
    #' Get Ocpm eligible conversion tags
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (map(array[ConversionEventResponse])) with additional information such as HTTP status code, headers
    #' @export
    OcpmEligibleConversionTagsGetWithHttpInfo = function(ad_account_id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling ConversionTagsApi$OcpmEligibleConversionTagsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling ConversionTagsApi$OcpmEligibleConversionTagsGet, must conform to the pattern ^\\d+$.")
      }

      local_var_url_path <- "/ad_accounts/{ad_account_id}/conversion_tags/ocpm_eligible"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "map(array[ConversionEventResponse])", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    },
    #' Get page visit conversion tags
    #'
    #' @description
    #' Get page visit conversion tags
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param page_size (optional) Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/getting-started/pagination/'>Pagination</a> for more information. (default value: 25)
    #' @param order (optional) The order in which to sort the items returned: “ASCENDING” or “DESCENDING” by ID. Note that higher-value IDs are associated with more-recently added items.
    #' @param bookmark (optional) Cursor used to fetch the next page of items
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return PageVisitConversionTagsGet200Response
    #' @export
    PageVisitConversionTagsGet = function(ad_account_id, page_size = 25, order = NULL, bookmark = NULL, data_file = NULL, ...) {
      local_var_response <- self$PageVisitConversionTagsGetWithHttpInfo(ad_account_id, page_size, order, bookmark, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get page visit conversion tags
    #'
    #' @description
    #' Get page visit conversion tags
    #'
    #' @param ad_account_id Unique identifier of an ad account.
    #' @param page_size (optional) Maximum number of items to include in a single page of the response. See documentation on <a href='/docs/getting-started/pagination/'>Pagination</a> for more information. (default value: 25)
    #' @param order (optional) The order in which to sort the items returned: “ASCENDING” or “DESCENDING” by ID. Note that higher-value IDs are associated with more-recently added items.
    #' @param bookmark (optional) Cursor used to fetch the next page of items
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (PageVisitConversionTagsGet200Response) with additional information such as HTTP status code, headers
    #' @export
    PageVisitConversionTagsGetWithHttpInfo = function(ad_account_id, page_size = 25, order = NULL, bookmark = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ad_account_id`)) {
        stop("Missing required parameter `ad_account_id`.")
      }

      if (nchar(`ad_account_id`) > 18) {
        stop("Invalid length for `ad_account_id` when calling ConversionTagsApi$PageVisitConversionTagsGet, must be smaller than or equal to 18.")
      }
      if (!str_detect(`ad_account_id`, "^\\d+$")) {
        stop("Invalid value for `ad_account_id` when calling ConversionTagsApi$PageVisitConversionTagsGet, must conform to the pattern ^\\d+$.")
      }

      if (`page_size` > 250) {
        stop("Invalid value for `page_size` when calling ConversionTagsApi$PageVisitConversionTagsGet, must be smaller than or equal to 250.")
      }
      if (`page_size` < 1) {
        stop("Invalid value for `page_size` when calling ConversionTagsApi$PageVisitConversionTagsGet, must be bigger than or equal to 1.")
      }



      query_params[["page_size"]] <- `page_size`

      if (!(`order` %in% c("ASCENDING", "DESCENDING"))) {
        stop("Invalid value for order when calling ConversionTagsApi$PageVisitConversionTagsGet. Must be [ASCENDING, DESCENDING].")
      }
      query_params[["order"]] <- `order`

      query_params[["bookmark"]] <- `bookmark`

      local_var_url_path <- "/ad_accounts/{ad_account_id}/conversion_tags/page_visit"
      if (!missing(`ad_account_id`)) {
        local_var_url_path <- gsub("\\{ad_account_id\\}", URLencode(as.character(`ad_account_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "ads:read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response_as_text(), "PageVisitConversionTagsGet200Response", loadNamespace("openapi")),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(paste("Server returned ", local_var_resp$status_code, " response status code."), local_var_resp)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new("API client error", local_var_resp)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || local_var_resp$response == "") {
          local_var_resp$response <- "API server error"
        }
        local_var_resp
      }
    }
  )
)
